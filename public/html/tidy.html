<html>
<head>
    <title>Tidy test</title>
    <link rel="stylesheet" href="indiana.css" />
    <script src="d3.v3.min.js" charset="utf-8"></script>
    <script src="autocomplete.js" charset="utf-8"></script>
    <style>
        body {
            font: 10px sans-serif;
        }

        .link {
            fill: none;
            stroke: #000;
        }

        .border {
            fill: none;
            shape-rendering: crispEdges;
            stroke: #aaa;
        }

        .node {
            stroke: #ff0000;
            fill: #ffffff;
            color: #000000;
            font: 10px sans-serif;
        }
    </style>
</head>

<body>

<script type="text/javascript">
var margin = {top: 140, right: 10, bottom: 140, left: 10},
    width  = 800 - margin.left - margin.right,
    height = 800 - margin.top - margin.bottom;

var orientations = {
    "left-to-right": {
        size: [height, width],
        x: function(d) { return d.y; },
        y: function(d) { return d.x; }
    }
}

var svg = d3.select("body").selectAll("svg")
        .data(d3.entries(orientations))
        .enter().append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

svg.append("rect")
        .attr("width", width)
        .attr("height", height)
        .attr("class", "border");

svg.append("text")
        .attr("x", 6)
        .attr("y", 6)
        .attr("dy", ".71em")
        .text(function(d) { return d.key; });

d3.json("graph.json", function(root) {
    svg.each(function(orientation) {
        console.log(orientation);

        var svg = d3.select(this),
              o = orientation.value;

        var tree  = d3.layout.tree().size(o.size),
            nodes = tree.nodes(root),
            links = tree.links(nodes);

        svg.selectAll(".link")
                .data(links)
                .enter().append("path")
                .attr("class", "link")
                .attr("d", d3.svg.diagonal().projection(function(d) { return [o.x(d), o.y(d)]; }));

        svg.selectAll(".node")
                .data(nodes)
                .enter().append("circle")
                .attr("class", "node")
                .attr("r", 10.5)
                .attr("cx", o.x)
                .attr("cy", o.y);

        svg.selectAll(".nodetext")
                .data(nodes)
                .enter().append("text")
                .attr("class", "node")
                .attr("x", o.x)
                .attr("y", o.y)
                .text(function(d) { return d.name; });
    });
});


</script>

</body>

</html>